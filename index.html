<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Label Creator</title>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/style.css">
  </head>
  <body>
    <div class="app">
      <header class="level">
        <div class="level-left">
          <div class="level-item">
            <div>
              <h1 class="title">Label Creator</h1>
              <p class="subtitle">Create printable label sheets in your browser.</p>
            </div>
          </div>
        </div>
        <div class="level-right">
          <div class="level-item">
            <div class="buttons">
              <button id="themeToggle" class="button is-light">Toggle theme</button>
            </div>
          </div>
        </div>
      </header>

      <section class="controls">
        <div style="width:100%;margin-bottom:6px;display:flex;align-items:center;gap:12px;flex-wrap:wrap">
          <strong style="margin-right:6px">Mode:</strong>
          <ul class="tabs is-toggle is-toggle-rounded" role="tablist" id="modeTabs" style="display:inline-flex;vertical-align:middle;margin:0">
            <li class="is-active" data-mode="labels" role="tab" aria-selected="true"><a href="javascript:void(0)">Label generator</a></li>
            <li data-mode="optimize" role="tab" aria-selected="false"><a href="javascript:void(0)">From Image</a></li>
          </ul>
          <!-- keep hidden radios for accessibility and backward compatibility with existing JS -->
          <input type="radio" name="mode" id="modeLabels" value="labels" checked style="display:none">
          <input type="radio" name="mode" id="modeOptimize" value="optimize" style="display:none">
        </div>

        <!-- wrap all label-related controls so mode toggling can hide/show the whole area -->
        <div id="labelsArea">
        <div id="layoutGroup" class="option-group">
          <label class="label-mode">
            Preset layout:
            <select id="layoutSelect">
                <option value="2x4" data-cols="2" data-rows="4" data-m="10" data-label-mode="standard">2 × 4</option>
                <option value="3x8" data-cols="3" data-rows="8" selected data-m="10" data-label-mode="standard">3 × 8</option>
                <option value="4x7" data-cols="4" data-rows="7" data-m="10" data-label-mode="standard">4 × 7</option>
                <option value="3x10" data-cols="3" data-rows="10" data-m="5" data-label-mode="thin">3 × 10 (many thin)</option>
                <option value="2x8" data-cols="2" data-rows="8" data-m="10" data-label-mode="standard">2 × 8</option>
              <option value="custom">Custom</option>
            </select>
          </label>

          <div class="custom-controls" style="display:flex;align-items:center;gap:8px;">
            <label class="label-mode">
              Columns:
              <input id="colsInput" type="number" min="1" max="10" value="3" style="width:60px">
            </label>
            <label class="label-mode">
              Rows:
              <input id="rowsInput" type="number" min="1" max="40" value="8" style="width:60px">
            </label>
          </div>
        </div>

        <label class="label-mode">
          Page size:
          <select id="pageSize">
            <option value="A4" selected>A4 (210 × 297 mm)</option>
            <option value="Letter">Letter (8.5 × 11 in)</option>
          </select>
        </label>

        <label class="label-mode">
          Margins:
          <select id="marginPreset">
            <option value="standard" data-m="10">Standard (10mm)</option>
            <option value="narrow" data-m="5">Narrow (5mm)</option>
            <option value="wide" data-m="20">Wide (20mm)</option>
            <option value="none" data-m="0">None (0mm)</option>
            <option value="custom">Custom</option>
          </select>
        </label>

        <div id="customMargins" class="label-mode conditional-box" style="display:none;align-items:center;gap:6px;">
          <input id="marginTop" placeholder="top mm" size="4">
          <input id="marginRight" placeholder="right mm" size="4">
          <input id="marginBottom" placeholder="bottom mm" size="4">
          <input id="marginLeft" placeholder="left mm" size="4">
        </div>

        <label class="label-mode">
          Border style:
          <select id="borderStyle">
            <option value="none" selected>None</option>
            <option value="dotted">Dotted</option>
            <option value="dashed">Dashed</option>
            <option value="solid">Solid</option>
            <option value="crossmarks">Crossmarks</option>
          </select>
        </label>

        <label class="label-mode">
          Label height:
          <select id="labelHeightMode">
            <option value="standard" selected>Standard (uses rows)</option>
            <option value="thin">Thin — single text line</option>
            <option value="custom">Custom (mm)</option>
          </select>
        </label>
        <input id="labelHeightCustom" class="label-mode conditional-box" placeholder="mm" size="4" style="display:none">
          <label>
            Order:
            <select id="orderMode">
              <option value="interleaved" selected>Sequential</option>
              <option value="grouped">Grouped (all of each label)</option>
              <option value="random">Random</option>
            </select>
          </label>

        <div class="label-defaults label-mode" style="display:flex;flex-direction:column;gap:8px;">
          <h3 style="margin:0 0 6px 0">Label defaults</h3>
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
            <label>
              Text size:
              <input id="fontSizeRange" type="range" min="6" max="24" value="12">
              <span id="fontSizeLabel">12pt</span>
            </label>
            <label>
              Font:
              <select id="fontSelect">
                <option value="system-ui,Segoe UI,Arial,sans-serif">System</option>
                <option value="Roboto,Arial,Helvetica,sans-serif">Roboto</option>
                <option value="'Helvetica Neue',Helvetica,Arial,sans-serif">Helvetica</option>
                <option value="Georgia,serif">Georgia</option>
                <option value="'Times New Roman',Times,serif">Times</option>
                <option value="'Courier New',Courier,monospace">Monospace</option>
              </select>
            </label>
            <label>
              Image position:
              <select id="imagePosition">
                <option value="center" selected>Center</option>
                <option value="top">Top</option>
                <option value="bottom">Bottom</option>
                <option value="left">Left</option>
                <option value="right">Right</option>
                <option value="top-left">Top-left</option>
                <option value="top-right">Top-right</option>
                <option value="bottom-left">Bottom-left</option>
                <option value="bottom-right">Bottom-right</option>
              </select>
            </label>
          </div>
        </div>

        <div class="add-label label-mode field has-addons">
          <div class="control is-expanded">
            <input id="labelText" class="input" placeholder="Label text">
          </div>
          <div class="control">
            <div class="file">
              <label class="file-label">
                <input id="labelImage" class="file-input" type="file" accept="image/*">
                <span class="file-cta"><span class="file-label">Choose</span></span>
              </label>
            </div>
          </div>
          <div class="control">
            <button id="addLabelBtn" class="button is-primary">Add Label</button>
          </div>
        </div>

        <div class="label-list label-mode box">
          <h3 class="title is-6">Labels</h3>
          <ul id="labels"></ul>
        </div>
        <div class="actions label-mode buttons">
          <button id="generateBtn" class="button is-primary">Generate Sheet</button>
          <button id="printBtn" class="button is-light">Print</button>
          <button id="clearAllBtn" class="button is-danger">Clear all</button>
        </div>
        </div>
      </section>

      <!-- Optimize layout section -->
      <section class="controls" id="optimizeSection" style="margin-top:12px;border-top:1px solid #eee;padding-top:12px;">
        <h3 style="width:100%">Optimize image layout</h3>
        <label>
          Select image:
          <input id="optimizeImageInput" type="file" accept="image/*">
        </label>
        <label>
          Preview:
          <img id="optimizePreview" src="" alt="" style="max-width:160px;max-height:120px;border:1px solid #ddd;padding:4px;background:#fff">
        </label>
        <label>
          Target width (mm):
          <input id="optimizeScale" type="range" min="10" max="200" step="1" value="50" style="width:200px">
          <span id="optimizeScaleLabel">50 mm</span>
        </label>
        <label>
          Gap between labels (mm):
          <input id="optimizeGap" type="number" min="0" max="50" value="6" style="width:80px"> 
        </label>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="optimizeAnalyzeBtn" class="button is-info">Analyze</button>
          <button id="optimizeAutoBtn" class="button">Auto optimize</button>
          <button id="optimizeGenerateBtn" class="button is-primary">Generate optimized sheet</button>
          <button id="optimizePrintBtn" class="button is-light">Print</button>
        </div>
        <div id="optimizeInfo" style="margin-top:8px;color:#333"></div>
      </section>

      <main>
        <h2>Preview / Sheet</h2>
        <div class="page">
          <div id="sheet" class="sheet"></div>
        </div>
      </main>
    
    <style id="dynamicStyle"></style>
    </div>

    <!-- Edit modal -->
    <div id="editModal" class="modal" aria-hidden="true">
      <div class="modal-content">
        <header>
          <h3>Edit Label</h3>
        </header>
        <div class="modal-body">
          <label>Text:
            <input id="modalLabelText">
          </label>
          <label>Font size:
            <input id="modalFontSize" type="number" min="6" max="48" value="12"> pt
          </label>
          <label>Font:
            <select id="modalFontSelect">
              <option value="system-ui,Segoe UI,Arial,sans-serif">System</option>
              <option value="Roboto,Arial,Helvetica,sans-serif">Roboto</option>
              <option value="'Helvetica Neue',Helvetica,Arial,sans-serif">Helvetica</option>
              <option value="Georgia,serif">Georgia</option>
              <option value="'Times New Roman',Times,serif">Times</option>
              <option value="'Courier New',Courier,monospace">Monospace</option>
            </select>
          </label>
          <label>Image position:
            <select id="modalImagePosition">
              <option value="center">Center</option>
              <option value="top">Top</option>
              <option value="bottom">Bottom</option>
              <option value="left">Left</option>
              <option value="right">Right</option>
              <option value="top-left">Top-left</option>
              <option value="top-right">Top-right</option>
              <option value="bottom-left">Bottom-left</option>
              <option value="bottom-right">Bottom-right</option>
            </select>
          </label>

          <label>Images:
            <input id="modalImageInput" type="file" accept="image/*" multiple>
          </label>
          <label><input id="modalManualPosition" type="checkbox"> Manual positioning</label>
          <div id="modalPreview" class="modal-preview" aria-hidden="true"></div>
          <div id="modalImages" class="modal-images"></div>
        </div>
        <footer>
          <button id="modalSave">Save</button>
          <button id="modalCancel">Cancel</button>
        </footer>
      </div>
    </div>
    <script src="./static/js/app.js"></script>
  </body>
</html>
